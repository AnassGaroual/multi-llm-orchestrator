#!/bin/sh
# Commit message hook - Enforce Conventional Commits
# https://www.conventionalcommits.org/

set -e

COMMIT_MSG_FILE=$1
COMMIT_MSG=$(cat "$COMMIT_MSG_FILE")

# Conventional commit pattern
PATTERN="^(feat|fix|docs|style|refactor|perf|test|build|ci|chore|revert)(\(.+\))?: .{1,72}"

if ! echo "$COMMIT_MSG" | grep -qE "$PATTERN"; then
  echo "‚ùå Invalid commit message format!"
  echo ""
  echo "Commit message must follow Conventional Commits:"
  echo "  <type>[optional scope]: <description>"
  echo ""
  echo "Valid types: feat, fix, docs, style, refactor, perf, test, build, ci, chore, revert"
  echo ""
  echo "Examples:"
  echo "  feat: add user authentication"
  echo "  fix(api): resolve null pointer exception"
  echo "  docs: update README with setup instructions"
  exit 1
fi

exit 0
